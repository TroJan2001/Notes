
The vulnerability and exploit (memory corruption vulnerability), dubbed “PwnKit” (CVE-2021-4034), uses the vulnerable “pkexec” tool, and allows a local user to gain root system privileges on the affected host, the exploit is fully explained here: https://www.mend.io/blog/polkit-pkexec-vulnerability-cve-2021-4034/.

# Exploitation

Download this file at the target machine: https://github.com/arthepsy/CVE-2021-4034/blob/main/cve-2021-4034-poc.c.

compile it using this command:

```bash
gcc cve-2021-4034-poc.c -o exploit
```

and run it:

```bash
./exploit
```

To check if the CVE is patched or not, we can use the following command:

```bash
zgrep -E 'CVE-2021-4034' /usr/share/doc/policykit-1/changelog.Debian.gz
```