The **N**map **S**cripting **E**ngine (NSE) is an incredibly powerful addition to Nmap, extending its functionality quite considerably. NSE Scripts are written in the _Lua_ programming language, and can be used to do a variety of things: from scanning for vulnerabilities, to automating exploits for them.

There are many categories available. Some useful categories include:

- `safe`:- Won't affect the target
- `intrusive`:- Not safe: likely to affect the target  
- `vuln`:- Scan for vulnerabilities
- `exploit`:- Attempt to exploit a vulnerability
- `auth`:- Attempt to bypass authentication for running services (e.g. Log into an FTP server anonymously)
- `brute`:- Attempt to bruteforce credentials for running services
- `discovery`:- Attempt to query running services for further information about the network (e.g. query an SNMP server).

**Note:** The full list and other resources could be found here in the resources tap.

**Important Note:** All of the NSE scripts are stored in this directory by default:
/usr/share/nmap/scripts

we can use `/usr/share/nmap/scripts/script.db` file to look at filenames and categories for each available script along with `grep` command.

or we can use `ls -l /usr/share/nmap/scripts/*ftp*` for example to search for ftp files in   `/usr/share/nmap/scripts/` directory.

# Useful Commands:

To scan using nmap you can simply try: 
```bash
nmap ip
```

**Check these switches below:**

|**Switch** | **Function** |  
| :-------:| :------:|
|-p|Scan a specific port of range of ports| 
|-p-|Scan all ports|
|-sS|Syn Scan|
|-sU|UDP scan|
|-O|Detect which operating system the target is running on|
|-sV|Detect the version of the services running on the target|
|-v|Provide more information by increasing verbosity|
|-vv|An extra level of verbosity|
|-oA|Save nmap results in three major formats|
|-oN|Save nmap results in a normal format|
|-oG|Save nmap results in a grepable format|
|-T|Set the timing template which increases the speed your scan runs at|
|--script|Activate a script from the nmap scripting library|

Nmap firewall evasion switches:

|**Evasion Approach** | **Nmap Argument** |  
| :-------:| :------:|
|Hide a scan with decoys|`-D DECOY1_IP1,DECOY_IP2,ME`|
|Use an HTTP/SOCKS4 proxy to relay connections|`--proxies PROXY_URL`|
|Spoof source MAC address|`--spoof-mac MAC_ADDRESS`|
|Spoof source IP address|`-S IP_ADDRESS`|
|Use a specific source port number|`-g PORT_NUM` or `--source-port PORT_NUM`|
|Fragment IP data into 8 bytes|`-f`|
|Fragment IP data into 16 bytes|`-ff`|
|Fragment packets with given MTU|`--mtu VALUE`|
|Specify packet length|`--data-length NUM`|
|Set IP time-to-live field|`--ttl VALUE`|
|Send packets with specified IP options|`--ip-options OPTIONS`|
|Send packets with a wrong TCP/UDP checksum|`--badsum`|
# Extra:

We mentioned previously that the Nmap website contains a list of scripts, so, what happens if one of these is missing in the `scripts` directory locally? A standard  should fix this; however, it's also possible to install the scripts manually by downloading the script from Nmap (`sudo wget -O /usr/share/nmap/scripts/<script-name>.nse https://svn.nmap.org/nmap/scripts/<script-name>.nse`). This must then be followed up with `nmap --script-updatedb`, which updates the `script.db` file to contain the newly downloaded script.

It's worth noting that you would require the same "updatedb" command if you were to make your own NSE script and add it into Nmap -- a more than manageable task with some basic knowledge of Lua!