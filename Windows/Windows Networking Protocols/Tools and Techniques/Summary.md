# ðŸ”¹ 1. Remote Execution & Lateral Movement

| Tool                                   | Flow                                                                                                                                             | Protocol/Transport                                              |
| -------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------- |
| **PsExec / Impacket-psexec**           | Authenticates via SMB â†’ creates a Windows Service (`PSEXESVC`) remotely â†’ service runs attacker command â†’ output piped back over SMB named pipe. | **SMB (445/tcp)** + Named Pipes (IPC$)                          |
| **SMBExec / Impacket-smbexec**         | Same SMB path, but instead of creating a service, it uses a semi-interactive shell via SMB pipes.                                                | **SMB (445/tcp)**                                               |
| **WMIExec / Impacket-wmiexec**         | Connects via DCOM/RPC â†’ issues WMI `Win32_Process.Create` call â†’ process runs remotely â†’ output redirected through SMB backchannel.              | **DCOM over MSRPC (135/tcp + dynamic RPC)** with SMB for output |
| **winexe**                             | Linux client for SMB service execution (similar to PsExec).                                                                                      | **SMB (445/tcp)**                                               |
| **Scheduled Task / atexec / DCOMExec** | Connects via RPC/DCOM â†’ schedules a task (Task Scheduler service) on target â†’ task runs attacker command.                                        | **MSRPC (135/tcp + dynamic)**                                   |
| **WinRM / evil-winrm / PS Remoting**   | Uses WS-Management protocol (SOAP over HTTP/S) â†’ remote PowerShell execution.                                                                    | **WinRM (5985/tcp HTTP, 5986/tcp HTTPS)**                       |

---
# ðŸ”¹ 2. Enumeration & Reconnaissance

| Tool / Technique               | Flow                                                                                 | Protocol/Transport                                |
| ------------------------------ | ------------------------------------------------------------------------------------ | ------------------------------------------------- |
| **rpcclient**                  | Queries MSRPC services (SAMR, LSARPC, Netlogon) for users, groups, SIDs, trusts.     | **MSRPC over SMB named pipes (445) or TCP (135)** |
| **RID Cycling**                | Abuse SAMR by iterating RIDs â†’ discover valid domain users/groups.                   | **MSRPC (SAMR) over SMB (445)**                   |
| **smbclient / smbmap**         | Enumerates SMB shares, permissions, file contents.                                   | **SMB (445/tcp)**                                 |
| **enum4linux / enum4linux-ng** | Wrapper for rpcclient, smbclient, net, nmblookup, LDAP â†’ dumps domain info.          | **SMB + RPC + LDAP (389/tcp)**                    |
| **Impacket Scripts**           | Python scripts (`samrdump`, `lookupsid`, `GetUserSPNs`) for SMB/MSRPC/Kerberos enum. | **SMB (445), MSRPC (135), Kerberos (88)**         |
| **Keimpx**                     | Validate creds/hashes against SMB hosts, list accessible shares.                     | **SMB (445)**                                     |
| **Nmap NSE**                   | Automates SMB/LDAP enumeration and brute-force with NSE scripts.                     | **SMB (445), LDAP (389), LDAPS (636)**            |
| **ldapsearch**                 | Direct LDAP queries to AD DS â†’ enumerate users, groups, policies, computers.         | **LDAP (389/tcp), LDAPS (636/tcp)**               |
| **Manspider / SMBcrunch**      | Crawl/search SMB shares for sensitive files (passwords, secrets, keys).              | **SMB (445)**                                     |
| **nxc (NetExec/CME)**          | Swiss-army: enumerate shares/sessions/users, spray creds, execute via SMB/WMI/WinRM. | **SMB (445), RPC, WinRM (5985/5986), WMI (135)**  |
| **BloodHound / PlumHound**     | Collects AD data (LDAP, SMB, RPC) â†’ graph analysis of paths and relationships.       | **LDAP (389), SMB (445), MSRPC (135)**            |
| **Kerberos Tools**             | Kerbrute (userenum/spray), Rubeus (roasting, ticket extraction/injection).           | **Kerberos (88/tcp & udp)**                       |

---
# ðŸ”¹ 3. Credential Extraction & Abuse

| Tool                                      | Flow                                                                                   | Protocol/Transport                    |
| ----------------------------------------- | -------------------------------------------------------------------------------------- | ------------------------------------- |
| **mimikatz**                              | Local only â†’ extracts from LSASS, SAM, tickets in memory.                              | **Local (no network)**                |
| **secretsdump.py (Impacket)**             | Uses DRSUAPI (MSRPC replication service) or SMB/SAMR to dump password hashes remotely. | **MSRPC over SMB (445/tcp)**          |
| **Rubeus**                                | Kerberos ticket request/renew/inject â†’ abuses KDC flows.                               | **Kerberos (88/tcp & udp)**           |
| **Kerbrute**                              | Brute-force user/password via Kerberos pre-auth.                                       | **Kerberos (88/tcp & udp)**           |
| **Kerberoasting / AS-REP Roasting**       | Asks KDC for TGS (Kerberoast) or AS-REP (no preauth) â†’ crack offline.                  | **Kerberos (88/tcp)**                 |
| **Pass-the-Hash (PsExec, WMIExec, etc.)** | Reuses NTLM hash in authentication handshake over SMB/DCOM.                            | **SMB, RPC, WinRM depending on tool** |

---
# ðŸ”¹ 4. Privilege Escalation

| Exploit / Technique                                               | Flow (what happens)                                                                                                                                                                  | Requirements / Starting Point                                                                  | Impact                                                             | Protocol / Transport                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ----------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------- | ------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **JuicyPotato / RoguePotato / PrintSpoofer**                      | Abuse **`SeImpersonatePrivilege`** to coerce a privileged service (e.g., Print Spooler) to authenticate; impersonate token â†’ spawn **SYSTEM**.                                       | Local code exec + `SeImpersonatePrivilege` (often present on service accounts)                 | **Local** admin/SYSTEM on that box (not AD by itself)              | Local RPC/Named Pipes; PrintSpoofer uses Spooler paths. ([juggernaut-sec.com](https://juggernaut-sec.com/seimpersonateprivilege/?utm_source=chatgpt.com "SeImpersonatePrivilege â€“ Windows Privilege Escalation"), [GitHub](https://github.com/itm4n/PrintSpoofer?utm_source=chatgpt.com "itm4n/PrintSpoofer: Abusing impersonation privileges ..."))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **PrintNightmare (CVE-2021-34527)**                               | Abuse Print Spooler RCE/priv-esc to load arbitrary code/driver.                                                                                                                      | Vulnerable/ misconfigured Spooler                                                              | Local SYSTEM or remote code exec paths; often foothold â†’ lateral   | MSRPC over SMB (Spooler). ([Microsoft Security Response Center](https://msrc.microsoft.com/blog/2021/07/clarified-guidance-for-cve-2021-34527-windows-print-spooler-vulnerability/?utm_source=chatgpt.com "Clarified Guidance for CVE-2021-34527 Windows Print ..."), [CISA](https://www.cisa.gov/news-events/alerts/2021/06/30/printnightmare-critical-windows-print-spooler-vulnerability?utm_source=chatgpt.com "PrintNightmare, Critical Windows Print Spooler Vulnerability"))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **ZeroLogon (CVE-2020-1472)**                                     | Exploit Netlogon crypto flaw to set DC machine account password to blank â†’ takeover DC.                                                                                              | Network access to DCâ€™s Netlogon                                                                | Immediate **Domain Admin / DC takeover**                           | **Netlogon (MS-NRPC)** over RPC. ([Microsoft Security Response Center](https://msrc.microsoft.com/blog/2020/10/attacks-exploiting-netlogon-vulnerability-cve-2020-1472/?utm_source=chatgpt.com "Attacks exploiting Netlogon vulnerability (CVE-2020-1472)"), [CrowdStrike](https://www.crowdstrike.com/en-us/blog/cve-2020-1472-zerologon-security-advisory/?utm_source=chatgpt.com "Zerologon (CVE-2020-1472): Overview, Exploit Steps and ..."))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **NoPac (CVE-2021-42278/42287)**                                  | **sAMAccountName spoofing** + KDC confusion chain â†’ obtain TGT as DC â†’ DA quickly.                                                                                                   | Low-priv domain user; unpatched DCs                                                            | Domain Admin in minutes                                            | Kerberos + LDAP changes. ([Secureworks](https://www.secureworks.com/blog/nopac-a-tale-of-two-vulnerabilities-that-could-end-in-ransomware?utm_source=chatgpt.com "Understanding noPac Vulnerabilities"), [The Hacker Recipes](https://www.thehacker.recipes/ad/movement/kerberos/samaccountname-spoofing?utm_source=chatgpt.com "sAMAccountName spoofing"))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **DCSync**                                                        | Use replication rights (or DA) to ask DC for **password hashes** via DRSUAPI (replication)                                                                                           | Replication rights (e.g., `Replicating Directory Changes*`) or DA                              | Dump **krbtgt** & all account secrets â†’ DA/persistence             | **DRSUAPI** (MSRPC over SMB). ([AdSecurity](https://adsecurity.org/?p=1729&utm_source=chatgpt.com "Mimikatz DCSync Usage, Exploitation, and Detection"))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **DCShadow**                                                      | Register a rogue DC and **push AD changes** that look like replication (stealthy)                                                                                                    | High privileges (DA/EA) to register DC                                                         | Stealthy object/ACL changes â†’ persistence                          | AD replication (RPC), masqueraded as legit. ([SentinelOne](https://www.sentinelone.com/blog/detecting-a-rogue-domain-controller-dcshadow-attack/?utm_source=chatgpt.com "DCShadow Attacks: Detecting a Rogue Domain Controller"), [DC Shadow](https://www.dcshadow.com/?utm_source=chatgpt.com "DCShadow attack"))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **Delegation Abuse (Unconstrained / Constrained / RBCD)**         | Abuse service accounts/computer objects allowed to delegate to obtain **service tickets** as victims â†’ impersonation. **RBCD** lets resource owners choose who can delegate to them. | Control of a delegatable account/computer or write on target computer (RBCD)                   | Lateral to high-value services / DA paths                          | Kerberos (S4U2Self/S4U2Proxy). ([GuidePoint Security](https://www.guidepointsecurity.com/blog/delegating-like-a-boss-abusing-kerberos-delegation-in-active-directory/?utm_source=chatgpt.com "Delegating Like a Boss: Abusing Kerberos ..."), [Altered Security](https://www.alteredsecurity.com/post/resource-based-constrained-delegation-rbcd?utm_source=chatgpt.com "Abusing Resource-Based Constrained Delegation (RBCD) ..."))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **ACL Abuse (AD rights)**                                         | Modify ACLs on users/computers/GPOs to grant `ResetPassword`, `AddMembers`, or `WriteDACL` â†’ escalate quietly.                                                                       | Any AD write permission on target object/container                                             | User takeover, GPO abuse, stealthy persistence                     | LDAP (389/636). (General practice; many writeups)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **ADCS Misconfig (ESC1â€“ESC8)**                                    | Request **auth certs** that map to arbitrary users/computers; or CA private key abuse â†’ logon as **anyone** (smartcard logon, etc.).                                                 | AD CS deployed with weak templates/EKUs or CA key exposure                                     | Full domain compromise / long-term persistence (Golden-cert style) | HTTP `certsrv`, RPC to CA; Kerberos/X.509 for auth. ([Posts By SpecterOps Team Members](https://posts.specterops.io/certified-pre-owned-d95910965cd2?utm_source=chatgpt.com "Certified Pre-Owned. Active Directory Certificate Servicesâ€¦"), [SpecterOps](https://specterops.io/wp-content/uploads/sites/3/2022/06/Certified_Pre-Owned.pdf?utm_source=chatgpt.com "Certified Pre-Owned"))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **NTLM Relay via Coercion (PetitPotam / PrinterBug / DFSCoerce)** | **Coerce** a machine/DC to authenticate to attacker, **relay** NTLM to LDAP/HTTP (often **ADCS**), mint cert as DC or modify AD.                                                     | Ability to coerce (EFSRPC, RPRN, DFSNM) + relay target accepting NTLM (e.g., ADCS without EPA) | DC cert issuance or LDAP writes â†’ DA                               | EFSRPC/RPRN/DFSNM RPC + NTLM relay to LDAP/HTTP. ([Microsoft Support](https://support.microsoft.com/en-us/topic/kb5005413-mitigating-ntlm-relay-attacks-on-active-directory-certificate-services-ad-cs-3612b773-4043-4aa9-b23d-b87910cd3429?utm_source=chatgpt.com "KB5005413: Mitigating NTLM Relay Attacks on Active ..."), [Rapid7](https://www.rapid7.com/blog/post/2021/08/03/petitpotam-novel-attack-chain-can-fully-compromise-windows-domains-running-ad-cs/?utm_source=chatgpt.com "PetitPotam Attack Chain Can Compromise Windows ..."), [The Hacker Recipes](https://www.thehacker.recipes/ad/movement/mitm-and-coerced-authentications/ms-rprn?utm_source=chatgpt.com "MS-RPRN abuse (PrinterBug)"), [Microsoft Tech Community](https://techcommunity.microsoft.com/blog/microsoft-security-blog/how-microsoft-defender-for-identity-protects-against-dfscoerce/3562912?utm_source=chatgpt.com "How Microsoft Defender for Identity protects against ...")) |
