- **Definition:**  
    An **HTTP Parameter Pollution** attack occurs when an attacker injects **extra or duplicate parameters** into an HTTP request.  
    Because web servers and frameworks handle multiple parameters differently, the polluted values may cause **unexpected behavior**, such as bypassing logic, redirecting data flows, or hijacking requests.
    
- **Impact:**
    
    - Exploitation of **business logic flaws** (e.g., bank transfers, unsubscribe links, share buttons).
        
    - **Bypass security controls** when multiple parameters overwrite each other.
        
    - Abuse of **third-party integrations** (social media, OAuth, unsubscribe).
        
    - Can lead to **account takeover, phishing, redirection, or sensitive action execution**.
        

---

## üîÑ General Attack Flow

1. Attacker identifies a parameter in use (`from=`, `to=`, `uid=`, `screen_name=`, etc.).
    
2. Attacker appends a **duplicate or crafted parameter** to the request.
    
3. Server or client-side logic handles it inconsistently:
    
    - First occurrence, last occurrence, or merge.
        
4. Application logic is altered (money moves from attacker‚Äôs account, unsubscribe affects another user, or redirects change destination).
    

**Example Flow (Server-Side):**

`Normal:  https://bank.com/transfer?from=12345&to=67890&amount=5000 Attack:  https://bank.com/transfer?from=12345&to=67890&amount=5000&from=ABCDEF`

- If backend trusts the **last `from` value**, transfer executes from **ABCDEF** instead of 12345.
    

---

## ‚ö° Real-World Case Studies

### 1. HackerOne Social Sharing Buttons

- **URL:**  
    `https://hackerone.com/blog/introducing-signal?&u=https://vk.com/durov`
    
- **What Happened:**
    
    - Appended `u` parameter to HackerOne blog share links.
        
    - When posted to Facebook/Twitter, the last `u` parameter took precedence.
        
    - Victims shared attacker‚Äôs link instead of HackerOne‚Äôs.
        
- **Bounty:** $500
    

‚úÖ **Impact:** Redirected social shares to attacker-controlled domains.

---

### 2. Twitter Unsubscribe Notifications

- **URL:**  
    `https://twitter.com/i/u?iid=F6542&uid=1134885524&nid=22...`
    
- **What Happened:**
    
    - Attacker added a **second `uid`** parameter.
        
    - Twitter validated `sig` against the first UID but executed unsubscribe with the second.
        
    - Allowed unsubscribing **other users‚Äô accounts**.
        
- **Bounty:** $700
    

‚úÖ **Impact:** Forced unsubscribe of other users from email notifications.

---

### 3. Twitter Web Intents

- **URL:**  
    `https://twitter.com/intent/follow?screen_name=twitter&screen_name=ericrtest3`
    
- **What Happened:**
    
    - Intent feature let attackers **overwrite the first `screen_name`** value.
        
    - Users clicking ‚ÄúFollow Twitter‚Äù ended up following attacker instead.
        
- **Bounty:** Undisclosed
    

‚úÖ **Impact:** Abused social features to gain fake followers.

---

## üîë Key Takeaways

- **Why dangerous:** HPP exploits **parameter precedence ambiguity** across server frameworks.
    
- **Common vulnerable parameters:**
    
    - `from=`, `to=`, `amount=`, `uid=`, `screen_name=`, `redirect=`, `u=`
        
- **Exploitation vectors:**
    
    1. **Duplicate parameters** ‚Üí last one overwrites.
        
    2. **URL encoding tricks** (`%26`, `%3D`) ‚Üí smuggle new params.
        
    3. **Client-side reflection** ‚Üí injected into href/action attributes.
        
    4. **3rd-party trust** ‚Üí share buttons, integrations.
        
- **Defense:**
    
    - Reject duplicate parameters.
        
    - Normalize request parsing consistently.
        
    - Use **whitelists** for critical parameters.
        
    - Sanitize reflected values in URLs.
        

---

## üö© Red Team Usage

- Money transfer manipulation.
    
- Hijacking unsubscribe/notification flows.
    
- Abusing share/redirect links.
    
- Smuggling actions in OAuth or web intents.
    

---

## üõ°Ô∏è Blue Team Checklist

- Test how framework handles duplicates (first, last, all).
    
- Monitor logs for repeated parameters (`id=1&id=2`).
    
- Inspect social share/unsubscribe flows.
    
- Validate inputs and enforce parameter uniqueness.
    

---

## Resources

Real-World Bug Hunting: A Field Guide to Web Hacking‚Äù by Peter Yaworski (No Starch Press, 2019).